\section{Theoretical Model}
\label{TheoreticalModelLabel}

Each loudspeaker is considered as a punctual source with a given radiation pattern. The acoustic pressure waves are propagated according to next equation:

\begin{equation}
P(\vec{r}) = c D_{loud}(\vec{r} - \vec{r_{loud}}) G(\vec{r} - \vec{r_{loud}})
\end{equation}

\begin{description}
	\item[$P(\vec{r})$] Acoustic pressure generated by the loudspeaker at the point $\vec{r}$
	\item[$c$] Complex coefficient of the signal transmitted
	\item[$D_{loud}$] Radiation pattern of the loudspeaker
	\item[$\vec{r_\mathit{loud}}$] Position of the loudspeaker
	\item[G] Green's function in 3D
\end{description}

In order to reproduce a signal through a loudspeaker, it must be created in the digital domain and then sent to the audio driver. The amplitude and phase relation between the digital signal created and the physical magnitude and phase of the transmitted one can be different for each loudspeaker. Hence, we need calibration coefficients for loudspeakers.

It is not possible to know the acoustic field at one point directly, we need to use a microphone that will transform the pressure to voltage, and then it will be digitized. The microphone will be modelled as a punctual receiver with a given radiation pattern and a calibration coefficient too.

%\begin{multline}
%x_{m,n}(f) = s_{m}(f) D_{s,m}(\mathbf{r}_{s,m}, \mathbf{r}_{r,n}, f) G(\mathbf{r}_{s,m}, \mathbf{r}_{r,n}, f) D_{r,n}(\mathbf{r}_{s,m}, \mathbf{r}_{r,n}, f) \\
%x_{n}(f) = \sum_{m = 1}^{M} \left( s_{m}(f) D_{s,m}(\mathbf{r}_{s,m}, \mathbf{r}_{r,n}, f) G(\mathbf{r}_{s,m}, \mathbf{r}_{r,n}, f) D_{r,n}(\mathbf{r}_{s,m}, \mathbf{r}_{r,n}, f) \right) + x_{noise}(f)
%\label{transFunctionComplete}
%\end{multline}
%
%Particularising for just one frequency the contribution of a loudspeaker to a point in space, in the absence of noise, is:

%\begin{equation}
%x_{l,m} = s_{l} D_{loud,l}(\mathbf{r}_{micro,m} - \mathbf{r}_{loud,l}) G(\mathbf{r}_{micro,m} - \mathbf{r}_{loud,l}) D_{micro,m}(\mathbf{r}_{micro,m} - \mathbf{r}_{loud,l})
%\label{transFunction}
%\end{equation}
%
%\begin{description}
%	\item[$x_{(l,m)}$] Complex contribution of the $l$-th loudspeaker to the signal received by the $m$-th microphone
%	\item[$s_{l}$] Complex coefficient of the signal transmitted by the $l$-th loudspeaker
%	\item[$D_{loud(l)}$] Radiation pattern of the $l$-th loudspeaker
%	\item[$D_{micro(m)}$] Radiation pattern of the $m$-th microphone
%	\item[$\mathbf{r}_{loud(l)}$] Position of the $l$-th loudspeaker
%	\item[$\mathbf{r}_{micro(m)}$] Position of the $m$-th microphone
%	\item[G] Green's function in 3D
%\end{description}

\begin{equation}
x_{l,m} = c_{l}^d \alpha_l D_{loud(l)}(\mathbf{r}_{loud(l)}, \mathbf{r}_{micro(m)}) G(\mathbf{r}_{loud(l)}, \mathbf{r}_{micro(m)}) D_{micro(m)}(\mathbf{r}_{loud(l)}, \mathbf{r}_{micro(m)}) \beta_m
\label{transEquationCalibration}
\end{equation}

\begin{description}
	\item[$x_{(l,m)}$] Complex contribution of the $l$-th loudspeaker to the signal received by the $m$-th microphone
	\item[$c_{l}^d$] Complex coefficient of the digital signal sent to the $l$-th loudspeaker
	\item[$\alpha_m$] Calibration coefficient for the $m$-th source (loudspeaker)
	\item[$D_{loud(l)}$] Radiation pattern of the $l$-th loudspeaker
	\item[$\mathbf{r}_{loud(l)}$] Position of the $l$-th loudspeaker
	\item[G] Green's function in 3D
	\item[$\mathbf{r}_{micro(m)}$] Position of the $m$-th microphone
	\item[$D_{micro(m)}$] Radiation pattern of the $m$-th microphone
	\item[$\beta_n$] Calibration coefficient for the $m$-th microphone
\end{description}
