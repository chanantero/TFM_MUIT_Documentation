\section{Theoretical Model}
\label{TheoreticalModelLabel}

Each loudspeaker is considered as a punctual source with a given radiation pattern. The acoustic pressure waves propagate according to next equation:

\begin{equation}
P = c_\mathit{loud} D_{loud} G = c_\mathit{loud} D_{loud} \frac{e^{-j k \norm{\vec{r} - \vec{r}_\mathit{loud}}}}{\norm{\vec{r} - \vec{r}_\mathit{loud}}}
\end{equation}

\begin{description}
	\item[$P$] Acoustic pressure generated by the loudspeaker at point $\vec{r}$
	\item[$c_\mathit{loud}$] Complex coefficient of the signal transmitted %($x(t) = \Re\{c e^{j \omega t}\}$)
	\item[$D_{loud}$] Loudspeaker's radiation pattern contribution in the direction from $\vec{r}_\mathit{loud}$ to point $\vec{r}$% $\frac{\vec{r} - \vec{r}_\mathit{loud}}{\norm{\vec{r} - \vec{r}_\mathit{loud}}}$
	\item[$\vec{r}_{\mathit{loud}}$] Position of the loudspeaker
	\item[$G$] Green's function value for the distance between the loudspeaker and the point %$\norm{\vec{r} - \vec{r}_\mathit{loud}}$
\end{description}

In order to reproduce a signal through a loudspeaker, it must be created in the digital domain and then sent to the audio driver. The amplitude and phase relation between the digital signal created and the physical magnitude and phase of the transmitted one can be different for each loudspeaker. Hence, we need calibration coefficients for loudspeakers.

It is not possible to know the acoustic field at one point directly, we need to use a microphone that will transform the pressure to voltage, and then it will be digitized. The microphone will be modelled as a punctual receiver with a given radiation pattern and a calibration coefficient too.

%\begin{equation}
%	x_{l,m} = c_{l}^d \alpha_l D_{loud(l)}(\mathbf{r}_{loud(l)}, \mathbf{r}_{micro(m)}) G(\mathbf{r}_{loud(l)}, \mathbf{r}_{micro(m)}) D_{micro(m)}(\mathbf{r}_{loud(l)}, \mathbf{r}_{micro(m)}) \beta_m
%	\label{transEquationCalibration}
%\end{equation}
%
%\begin{description}
%	\item[$x_{(l,m)}$] Complex contribution of the $l$-th loudspeaker to the signal received by the $m$-th microphone
%	\item[$c_{l}^d$] Complex coefficient of the digital signal sent to the $l$-th loudspeaker
%	\item[$\alpha_m$] Calibration coefficient for the $m$-th source (loudspeaker)
%	\item[$D_{loud(l)}$] Radiation pattern of the $l$-th loudspeaker
%	\item[$\mathbf{r}_{loud(l)}$] Position of the $l$-th loudspeaker
%	\item[G] Green's function in 3D
%	\item[$\mathbf{r}_{micro(m)}$] Position of the $m$-th microphone
%	\item[$D_{micro(m)}$] Radiation pattern of the $m$-th microphone
%	\item[$\beta_n$] Calibration coefficient for the $m$-th microphone
%\end{description}

\begin{equation}
c_\mathit{micro} = c_\mathit{loud} \alpha D_{loud} G D_{micro} \beta = a \, c_\mathit{loud}
\label{transEquationCalibration}
\end{equation}

\begin{description}
	\item[$c_\mathit{micro}$] Complex coefficient of the signal received from the microphone
	\item[$c_\mathit{loud}$] Complex coefficient of the digital signal sent to the loudspeaker
	\item[$a$] Acoustic path
	\item[$\alpha$] Calibration coefficient for the loudspeaker
	\item[$\beta$] Calibration coefficient for the microphone
	\item[$D_{loud}$] Loudspeaker's radiation pattern contribution in the direction from $\vec{r}_{loud}$ to $\vec{r}_{micro}$
	\item[$D_{micro}$] Microphone's radiation pattern contribution in the direction from $\vec{r}_{micro}$ to $\vec{r}_{loud}$ 
	\item[$G$] Green's function value for the distance between loudspeaker and microphone
	\item[$\vec{r}_{loud}$] Position of loudspeaker
	\item[$\vec{r}_{micro}$] Position of microphone
\end{description}

If there are multiple microphones and loudspeakers, the relation between the transmitted and received signals for each combination of loudspeaker and microphone is characterized by an acoustic path. Let $L$ and $M$ be the number of loudspeakers and microphones respectively, then there are $L \dot M$ combinations.

\begin{gather}
c_{\mathit{micro} (m)} = \sum_{l = 1}^{L} a_{m,l} c_{\mathit{loud} (l)} \label{transEquationCalibrationConcrete} \\
a_{m,l} = \alpha_l D_{loud(l,m)} G_{l,m} D_{micro(l,m)} \beta_m
\label{acPathTheoric}
\end{gather}

\begin{description}
	\item[$D_{loud(l,m)}$] Loudspeaker's radiation pattern contribution in the direction from the $l$-th loudspeaker and the $m$-th microphone
	\item[$G_{l,m}$] Green's function value for the distance between the $l$-th loudspeaker and the $m$-th microphone
	\item[$D_{micro(l,m)}$] Microphone's radiation pattern contribution in the direction from the $m$-th microphone and the $l$-th loudspeaker
\end{description}

Previous equation can be expressed as a matrix operation:

\begin{equation}
\vec{c_\mathit{micro}} = \myMatrix{A} \vec{c_\mathit{loud}}
\label{transEqMatrix}
\end{equation}

\begin{description}
	\item[$\vec{c_\mathit{micro}}$] Column vector of signals transmitted by loudspeakers
	\item[$\vec{c_\mathit{loud}}$] Column vector of signals received by microphones
	\item[$\myMatrix{A}$] Acoustic path matrix. The element in the $m$-th row and $l$-th column is $a_{m,l}$
\end{description}



